<html>

<head>
	<title>Code Generator</title>
	<link rel=StyleSheet href="./stylesheet.css" type="text/css" media=screen>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
</head>

<body onload="generateCodeOnload()">
	<script type="text/javascript">
		var textGlobal = "";
		var i = 0;
		var j = 0;
		var causeCount=0;
		var effectCount=0;
		var resetFlag="";
		function generateCodeOnload(resetFlag) {
			document.getElementById("causeDiv").style.display = "none";
			document.getElementById("previewAction").style.display = "none";
			document.getElementById("cause").value = "-1";
			document.getElementById("watchReg").value = "";
			document.getElementById("label").value = "";
			//document.getElementsByName("targetAddr").value = "";
			//document.getElementById("operation").value = "-1";
			//document.getElementsByName("bitNumber").value = "";
			document.getElementsByName("targetEffectAddr").value = "";
			document.getElementById("operationEffect").value = "-1";
			document.getElementsByName("bitNumberEffect").value = "";
			document.getElementById("inputFileNameToSaveAs").value = "";
			document.getElementById("chiplet").value = "-1";
			document.getElementById("addrChoice").value = "-1";

			$(".bitNumber").hide();
			$(".bitNumCause").hide();
			$(".box1").hide();
			$(".box1Cause").hide();
			$(".box2").hide();
			$(".box2Cause").hide();
			
			$(".bitNumEffect").hide();
			$(".bitNumberEffect").hide();
			$(".box1Eff").hide();
			$(".box1effect").hide();
			$(".box2Eff").hide();
			$(".box2effect").hide(); 
			$(".dropdown-cause-bit-type").hide();
			$(".dropdown-effect-bit-type").hide();
			$(".dropdown-cause-literal-type").hide();
			$(".dropdown-effect-literal-type").hide();
			$(".dropdown-parent-chiplet").hide();
			
			$('#operation').prop('selectedIndex',0);
			$('#operationEffect').prop('selectedIndex',0);
			$('#dataTypeEffect').prop('selectedIndex',0);
			$('#literalTypeEffect').prop('selectedIndex',0);
			$('#noOfBitsEffect').prop('selectedIndex',0);
			$('#dataTypeCause').prop('selectedIndex',0);
			$('#literalTypeCause').prop('selectedIndex',0);
			$('#noOfBitsCause').prop('selectedIndex',0);
			
			$('.dropdown-parent-cause input[type="text"]').val('');
			$('.dropdown-parent-effect input[type="text"]').val('');

			$('input[type=checkbox]').each(function() 
			{ 
				this.checked = false; 
			}); 

			// Removing newly added cause and effect rows
			if(resetFlag=="Y"){
				if(causeCount>0){
					for(k=2;k<=causeCount;k++){
						var divid='causeDiv'+k;
						$("#"+divid).remove();
					}
				}
				if(effectCount>0){
					for(p=2;p<=causeCount;p++){
						var divid='effectDiv'+p;
						$("#"+divid).remove();
					}
				}
			}
		}
		function showCauseDiv() {
			//alert("inside cause div onchange");
			if (document.getElementById("cause").value == 'yes') {
				document.getElementById("causeDiv").style.display = "block";
			}
			else if (document.getElementById("cause").value == 'no') {
				document.getElementById("causeDiv").style.display = "none";
			}
		}
		function previewAct() {
			var value = [];
			$(':checkbox:checked').each(function(i){
				value[i] = $(this).val();
			});
			var chiplet_values=value.toString();

			var causeText="";
			var effectText="";
			var textToSave = document.getElementById("prevAction").value;		
			var label = document.getElementById("label").value;
			var cause = document.getElementById("cause").value;
			var chiplet = document.getElementById("chiplet").value;
			var addrChoice = document.getElementById("addrChoice").value;
			var watchReg = document.getElementById("watchReg").value;

			if(chiplet=='-1'){
				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please select if you want to apply for Chiplet or not");
				return false;
			}else if(label==''){
				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please provide label value");
				return false;
			}
			else if(addrChoice=='-1'){
				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please select your choice of address");
				return false;
			}else if(watchReg==''){
				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please provide watch register address");
				return false;
			}else if(watchReg!='' && !isValidhexValueWatchReg(watchReg)){
				
				textToSave='';
				document.getElementById("previewAction").style.display = "none";
				alert("Please enter valid 32 or 64 bit value in Watch Register");
				return false;
			}
			
			else if(cause=='-1'){
			
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please choose if you want to select cause or not");
				return false;
			}

			document.getElementById("previewAction").style.display = "block";
			
				//Get Effect values
				var effectDiv_values = '';
				var addrTypeEff='';
				var dataEffect='';
				var maskEffect='';
				$('.dropdown-parent-effect').each(function() {
						addrTypeEff= $(this).find('#dataTypeEffect').val();
						var text1 = $(this).find('.targetEffectAddr').val();
						var text2 = $(this).find('#operationEffect').val();

						if(text2=='BIT_ON' || text2=='BIT_OFF'){
							var text3 = $(this).find('.bitNumberEffect').val();
							
							if(addrTypeEff=='-1' || text1=='' || text2=='-1' || text3==''){
								alert("Please fill up details in Row in Effects before Preview");
								textToSave="";
								document.getElementById("previewAction").style.display = "none";
								return false;
							}
							
							effectDiv_values += '|'+ text1 +','+ text2 +','+ text3 +','+ addrTypeEff;
						}else if(text2=='EQUALTO' || text2=='AND' || text2=='OR'){
							dataEffect=$(this).find('.box1effect').val();
							maskEffect=$(this).find('.box2effect').val();
							var literalTypeEff=$(this).find('#literalTypeEffect').val();
							var noOfBitsEff= $(this).find('#noOfBitsEffect').val();
							
							if(addrTypeEff=='-1' || text1=='' || text2=='-1' || dataEffect=='' || literalTypeEff=='-1' || noOfBitsEff=='-1'){
								alert("Please fill up details in Row in Effects before Preview");
								textToSave="";
								document.getElementById("previewAction").style.display = "none";
								return false;
							}
							
							effectDiv_values += '|'+ text1 +','+ text2 +','+ dataEffect+','+maskEffect+','+ literalTypeEff+','+noOfBitsEff+','+addrTypeEff;
					    }
						else{
							if(addrTypeEff=='-1' || text1=='' || text2=='-1'){
								alert("Please fill up details in Row in Effects before Preview");
								textToSave="";
								document.getElementById("previewAction").style.display = "none";
								return false;
							}
							effectDiv_values += '|'+ text1 +','+ text2 +','+ addrTypeEff;
						}						
				});

				var count_eff=(effectDiv_values.split("|").length - 1);
				var effect_arr;
				effect_arr=effectDiv_values.split("|");
				for(i=1;i<=count_eff;i++){
					var effect_arr_val=effect_arr[i].split(",");
					var addrEff=effect_arr_val[0];
					var operationEff=effect_arr_val[1];
					
					if(!isValidhexValueTargetEffect(addrEff)){					
						textToSave='';
						document.getElementById("previewAction").style.display = "none";
						alert("Please enter valid 32 or 64 bit value in Target Address in Effect");
						return false;
					}

					if(operationEff=='BIT_ON'){
						var bitNumberEff=effect_arr_val[2];
						operationEff='BIT,ON';
						addrTypeEff=effect_arr_val[3];
					}else if(operationEff=='BIT_OFF'){
						var bitNumberEff=effect_arr_val[2];
						operationEff='BIT,OFF';
						addrTypeEff=effect_arr_val[3];
					}
					else if(operationEff=='EQUALTO' || operationEff=='AND' || operationEff=='OR'){
						// Logic to set values when EQUALTO is the option: values to set watchReg, addr, operation
						dataEffect=effect_arr_val[2];
						maskEffect=effect_arr_val[3];
						var literalTypeEffect=effect_arr_val[4];
						var noOfBitsEffect=effect_arr_val[5];
						addrTypeEff=effect_arr_val[6];
						
						if(noOfBitsEffect=='32'){
							if(!isValidhex_32(dataEffect)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 32 bit value in Data in Effect");
								return false;
							}
							else if(maskEffect!='' && !isValidhex_32(maskEffect)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 32 bit value in Mask in Effect");
								return false;
							}
						}
						else if(noOfBitsEffect=='64'){
							if(!isValidhex_64(dataEffect)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 64 bit value in Data in Effect");
								return false;
							}else if(maskEffect!='' && !isValidhex_64(maskEffect)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 64 bit value in Mask in Effect");
								return false;
							}
							else{
									var temp1=dataEffect.substring(2,10);
									var temp2=dataEffect.substring(10);
									dataEffect="0x"+temp1+" 0x"+temp2;
									if(maskEffect!=''){
										var temp3=maskEffect.substring(2,10);
										var temp4=maskEffect.substring(10);
										maskEffect="0x"+temp3+" 0x"+temp4;
									}
							}
						}
						
						if(literalTypeEffect=='literalEffect'){
							dataEffect="LITERAL("+noOfBitsEffect+","+dataEffect+")";
							if(maskEffect==''){
								operationEff="["+operationEff+",BUF]";
							}else{
								maskEffect="LITERAL("+noOfBitsEffect+","+maskEffect+")";
								operationEff="["+operationEff+",BUF,MASK]";
							}
						}else{
							//alert("inside reg effect");
							if(addrTypeEff=='logicEffect'){
								dataEffect="LOGIC("+dataEffect+")";
								if(maskEffect==''){
									operationEff="["+operationEff+",BUF]";
								}else{
									maskEffect="LOGIC("+maskEffect+")";
									operationEff="["+operationEff+",BUF,MASK]";
								}
							}else if(addrTypeEff=='regEffect'){
								if(chiplet!='-1' && chiplet=='yes'){
									dataEffect="REG(MYCHIPLET,"+dataEffect+")";
									if(maskEffect==''){
										operationEff="["+operationEff+",BUF]";
									}else{
										maskEffect="REG(MYCHIPLET,"+maskEffect+")";
										operationEff="["+operationEff+",BUF,MASK]";
									}
								}else if(chiplet!='-1' && chiplet=='no'){
									dataEffect="REG("+dataEffect+")";
									if(maskEffect==''){
										operationEff="["+operationEff+",BUF]";
									}else{
										maskEffect="REG("+maskEffect+")";
										operationEff="["+operationEff+",BUF,MASK]";
									}
								}
							}
						}
					}else{
						addrTypeEff=effect_arr_val[2];
					}
					
					if(addrTypeEff!='-1' && addrTypeEff=='logicEffect'){
						addrEff="LOGIC(" + addrEff + ")";
					}
					else if(addrTypeEff!='-1' && addrTypeEff=='regEffect'){
						if(chiplet!='-1' && chiplet=='yes'){
							addrEff="REG(MYCHIPLET," + addrEff + ")";
						}else if(chiplet!='-1' && chiplet=='no'){
							addrEff="REG(" + addrEff + ")";
						}
					}
					
					if(effectText==""){
						if(operationEff=='BIT,ON' || operationEff=='BIT,OFF'){
							effectText="\nEFFECT: TARGET=[" + addrEff + "] OP=[" + operationEff + "] BIT=[" + bitNumberEff + "]";
						}
						else if(operationEff.includes('EQUALTO') || operationEff.includes('AND') || operationEff.includes('OR')){
							if(operationEff.includes('MASK')){
								effectText="\nEFFECT: TARGET=[" + addrEff + "] OP="+ operationEff +" DATA=[" + dataEffect + "] MASK=[" + maskEffect + "]";
							}else{
								effectText="\nEFFECT: TARGET=[" + addrEff + "] OP="+ operationEff +" DATA=[" + dataEffect + "]";
							}
					    }else{
							effectText="\nEFFECT: TARGET=[" + addrEff + "] OP=[" + operationEff + "]";
						}						
					}
					else{
						if(operationEff=='BIT,ON' || operationEff=='BIT,OFF'){
							effectText=effectText+"\nEFFECT: TARGET=[" + addrEff + "] OP=[" + operationEff + "] BIT=[" + bitNumberEff + "]";
					}
					else if(operationEff.includes('EQUALTO') || operationEff.includes('AND') || operationEff.includes('OR')){
						if(operationEff.includes('MASK')){
							effectText=effectText+"\nEFFECT: TARGET=[" + addrEff + "] OP=" + operationEff + " DATA=[" + dataEffect + "] MASK=[" + maskEffect + "]";
						}else{
							effectText=effectText+"\nEFFECT: TARGET=[" + addrEff + "] OP=[" + operationEff + "] DATA=[" + dataEffect + "]";
						}
					}
					else{
						 effectText=effectText+"\nEFFECT: TARGET=[" + addrEff + "] OP=[" + operationEff + "]";
					    }						
				    }
				}
				
			// Effect part ends	
			
			// Get Cause Values
		if(cause=='yes')
		{
			var causeDiv_values = '';
			var addrType='';
			var dataCause='';
			var maskCause='';

				$('.dropdown-parent-cause').each(function() {
					addrType= $(this).find('#dataTypeCause').val();
					var text1 = $(this).find('.targetAddr').val();
					var text2 = $(this).find('#operation').val();
					
					if(text2=='BIT_ON' || text2=='BIT_OFF' ){
						var text3 = $(this).find('.bitNumber').val();

						if(addrType=='-1' || text1=='' || text2=='-1' || text3==''){
							alert("Please fill up details in Row in Cause before Preview");
							textToSave="";
							document.getElementById("previewAction").style.display = "none";
							return false;
						}

						causeDiv_values +='|'+ text1 +','+ text2 +','+ text3+','+addrType;
					}else if(text2=='EQUALTO' || text2=='AND' || text2=='OR'){
						var literalType=$(this).find('#literalTypeCause').val();
						var noOfBits= $(this).find('#noOfBitsCause').val();
						dataCause=$(this).find('.box1').val();
						maskCause=$(this).find('.box2').val();
						
						if(addrType=='-1' || text1=='' || text2=='-1' || literalType=='-1' || noOfBits=='-1' || dataCause==''){
							alert("Please fill up details in Row in Cause before Preview");
							textToSave="";
							document.getElementById("previewAction").style.display = "none";
							return false;
						}

						causeDiv_values += '|'+ text1 +','+ text2 +','+ dataCause+','+maskCause+','+ literalType+','+noOfBits+','+addrType;
					}else {
						
						if(addrType=='-1' || text1=='' || text2=='-1'){
							alert("Please fill up details in Row in Cause before Preview");
							textToSave="";
							document.getElementById("previewAction").style.display = "none";
							return false;
						}

						causeDiv_values += '|'+ text1 +','+ text2+','+addrType;
					}
				});
	
			var count=(causeDiv_values.split("|").length - 1);
			var cause_arr;
			cause_arr=causeDiv_values.split("|");
			for(i=1;i<=count;i++){
				var cause_arr_val=cause_arr[i].split(",");
				var addr=cause_arr_val[0];
				var operation=cause_arr_val[1];
				if(!isValidhexValueTargetCause(addr)){
					alert("Please enter valid 32 or 64 bit value in Target Address in Cause");
					textToSave='';
					document.getElementById("previewAction").style.display = "none";
				}
				if(operation=='BIT_ON'){
					var bitNumber=cause_arr_val[2];
					operation='BIT,ON';
					addrType=cause_arr_val[3];
				}else if(operation=='BIT_OFF'){
					var bitNumber=cause_arr_val[2];
					operation='BIT,OFF';
					addrType=cause_arr_val[3];
				}
				else if(operation=='EQUALTO' || operation=='AND' || operation=='OR'){
					// Logic to set values when EQUALTO is the option: values to set watchReg, addr, operation, box1, box2
					dataCause=cause_arr_val[2];
					maskCause=cause_arr_val[3];
					var literalType=cause_arr_val[4];
					var noOfBits=cause_arr_val[5];
					addrType=cause_arr_val[6];

					if(noOfBits=='32'){
							if(!isValidhex_32(dataCause)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 32 bit value in Data in Cause");
								return false;
							}
							else if(maskCause!='' && !isValidhex_32(maskCause)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 32 bit value in Mask in Cause");
								return false;
							}
					}
					else if(noOfBits=='64'){
							if(!isValidhex_64(dataCause)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 64 bit value in Data in Cause");
								return false;
							}else if(maskCause!='' && !isValidhex_64(maskCause)){								
								textToSave='';
								document.getElementById("previewAction").style.display = "none";
								alert("Please enter valid 64 bit value in Mask in Cause");
								return false;
							}
							else{
									var temp1=dataCause.substring(2,10);
									var temp2=dataCause.substring(10);
									dataCause="0x"+temp1+" 0x"+temp2;
									if(maskCause!=''){
										var temp3=maskCause.substring(2,10);
										var temp4=maskCause.substring(10);
										maskCause="0x"+temp3+" 0x"+temp4;
									}
							}
					}

					if(literalType=='literalCause'){
						dataCause="LITERAL("+noOfBits+","+dataCause+")";
						if(maskCause==''){
							operation="["+operation+",BUF]";
						}else{
							maskCause="LITERAL("+noOfBits+","+maskCause+")";
							operation="["+operation+",BUF,MASK]";
						}
    				}else{
						if(addrType=='logicCause'){
							dataCause="LOGIC("+dataCause+")";
						if(maskCause==''){
							operation="["+operation+",BUF]";
						}else{
							maskCause="LOGIC("+maskCause+")";
							operation="["+operation+",BUF,MASK]";
						}
						}else if(addrType=='regCause'){
							if(chiplet!='-1' && chiplet=='yes'){
								dataCause="REG(MYCHIPLET,"+dataCause+")";
								if(maskCause==''){
									operation="["+operation+",BUF]";
								}else{
									maskCause="REG(MYCHIPLET,"+maskCause+")";
									operation="["+operation+",BUF,MASK]";
								}
							}else if(chiplet!='-1' && chiplet=='no'){
								dataCause="REG("+dataCause+")";
								if(maskCause==''){
									operation="["+operation+",BUF]";
								}else{
									maskCause="REG("+maskCause+")";
									operation="["+operation+",BUF,MASK]";
								}
							}
						}
    				}
				}
				else{
					addrType=cause_arr_val[2]; // For ALLONES AND ALLZEROS
				}
				if(addrChoice!='-1' && addrChoice=='logic'){
					watchReg="LOGIC(" + watchReg + ")";
				}
				else if(addrChoice!='-1' && addrChoice=='reg'){
					if(chiplet!='-1' && chiplet=='yes'){
						watchReg="REG(MYCHIPLET," + watchReg + ")";
					}else if(chiplet!='-1' && chiplet=='no'){
						watchReg="REG(" + watchReg + ")";
					}
				}
				if(addrType!='-1' && addrType=='logicCause'){
					addr="LOGIC(" + addr + ")";
				}
				else if(addrType!='-1' && addrType=='regCause'){
					if(chiplet!='-1' && chiplet=='yes'){
						addr="REG(MYCHIPLET," + addr + ")";
					}else if(chiplet!='-1' && chiplet=='no'){
						addr="REG(" + addr + ")";
					}
				}

				if(causeText==""){
					if(operation=='BIT,ON' || operation=='BIT,OFF'){
						if(chiplet=='yes'){
							causeText="CAUSE_EFFECT CHIPLETS "+chiplet_values+"{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=[" + operation + "] BIT=[" + bitNumber + "]";
						}else{
							causeText="CAUSE_EFFECT{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=[" + operation + "] BIT=[" + bitNumber + "]";
						}						
					}else if(operation.includes('EQUALTO') || operation.includes('AND') || operation.includes('OR')){
						if(operation.includes('MASK')){
							if(chiplet=='yes'){
								causeText="CAUSE_EFFECT CHIPLETS "+chiplet_values+"{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=" + operation + " DATA=[" + dataCause + "] MASK=[" + maskCause + "]";
							}else{
								causeText="CAUSE_EFFECT{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=" + operation + " DATA=[" + dataCause + "] MASK=[" + maskCause + "]";
							}	
						}else{
							if(chiplet=='yes'){
								causeText="CAUSE_EFFECT CHIPLETS "+chiplet_values+"{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=" + operation + " DATA=[" + dataCause + "]";
							}else{
								causeText="CAUSE_EFFECT{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=" + operation + " DATA=[" + dataCause + "]";
							}
						}
					}
					else{
						if(chiplet=='yes'){
							causeText="CAUSE_EFFECT CHIPLETS "+chiplet_values+"{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=[" + operation + "]";
						}else{
							causeText="CAUSE_EFFECT{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "] \nCAUSE: TARGET=[" + addr + "] OP=[" + operation + "]";
						}						
					}
				}else{
					if(operation=='BIT,ON' || operation=='BIT,OFF'){
						causeText=causeText+"\nCAUSE: TARGET=[" + addr + "] OP=[" + operation + "] BIT=[" + bitNumber + "]";
					}else if(operation.includes('EQUALTO') || operation.includes('AND') || operation.includes('OR')	){
						if(operation.includes('MASK')){
							causeText=causeText+"\nCAUSE: TARGET=[" + addr + "] OP=" + operation + " DATA=[" + dataCause + "] MASK=[" + maskCause + "]";
						}else{
							causeText=causeText+"\nCAUSE: TARGET=[" + addr + "] OP=" + operation + " DATA=[" + dataCause + "]";
						}
					}else{
						causeText=causeText+"\nCAUSE: TARGET=[" + addr + "] OP=[" + operation + "]";
					}					
				}
			}
		}
			// Cause Part ends
			if(cause == 'no'){
				if(chiplet=='yes'){
					effectText="CAUSE_EFFECT CHIPLETS "+chiplet_values+"{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "]"+effectText+"}";
				}
				else{
					effectText="CAUSE_EFFECT{\nWATCH=[" + watchReg + "] \nLABEL=[" + label + "]"+effectText+"}";
				}				
				textToSave=effectText;
			}
			else if(cause == 'yes'){
				effectText=effectText+"}";
				textToSave=causeText+effectText;
			}
			textGlobal=textToSave;
			document.getElementById("prevAction").value = textToSave;
		}
		function hidePreviewAct() {
			document.getElementById("previewAction").style.display = "none";
		}
		function replaceAll(str, find, replace) {
    		return str.replace(new RegExp(find, 'g'), replace);
		}

		function saveTextAsFile() {
			var chiplet = document.getElementById("chiplet").value;
			var addrChoice = document.getElementById("addrChoice").value;
			var watchReg = document.getElementById("watchReg").value;
			var label = document.getElementById("label").value;
			var cause = document.getElementById("cause").value;
			
			if(chiplet=='-1'){				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please select if you want to apply for Chiplet or not");
				return false;
			}else if(label==''){				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please provide label value");
				return false;
			}
			else if(addrChoice=='-1'){				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please select your choice of address");
				return false;
			}else if(watchReg==''){				
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please provide watch register address");
				return false;
			}else if(watchReg!='' && !isValidhexValueWatchReg(watchReg)){				
				textToSave='';
				document.getElementById("previewAction").style.display = "none";
				alert("Please enter valid 32 or 64 bit value in Watch Register");
				return false;
			}
			
			else if(cause=='-1'){			
				textToSave="";
				document.getElementById("previewAction").style.display = "none";
				alert("Please choose if you want to select cause or not");
				return false;
			}

			var textToSave = textGlobal;			
			textToSave = textToSave.replace(/\n/g, "\r\n");
			var textToSaveAsBlob = new Blob([textToSave], { type: "text/plain" });
			var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
			var fileNameToSaveAs = document.getElementById("inputFileNameToSaveAs").value;

			var downloadLink = document.createElement("a");
			downloadLink.download = fileNameToSaveAs;
			downloadLink.innerHTML = "Download File";
			downloadLink.href = textToSaveAsURL;
			downloadLink.onclick = destroyClickedElement;
			downloadLink.style.display = "none";
			document.body.appendChild(downloadLink);
			downloadLink.click();
			textGlobal="";
		}
		function destroyClickedElement(event) {
			document.body.removeChild(event.target);
		}
		function resetAllFields() {
			var resetFlag="Y";
			generateCodeOnload(resetFlag);
			document.getElementById("prevAction").value='';
		}

		function addCause(that) {
			var lastCount = $(that).parent().parent().find('.dropdown-parent-cause').last().data().count;
			addDiv('causeDiv', `<div class="dropdown-cause-data-type" style="margin-left:-14px">Address type:<select id="dataTypeCause" style="margin-left:4px"><option value="-1">Select One</option><option value="regCause">Reg</option><option value="logicCause">Logic</option></select></div><label style="margin-left:4px">Target Address</label><input type = "text" class ="targetAddr" style="margin-left:5px;width:90px" onblur="isValidhexTargetAddressCause(this)"/><div class="dropdown-cause-operation" style="margin-left:3px">Operation: <select id="operation" onchange="showProperTextBox(this)"><option value="-1">Select One</option><option value="AND">AND</option><option value="OR">OR</option><option value="EQUALTO">EQUALTO</option><option value="BIT_ON">BIT_ON</option><option value="BIT_OFF">BIT_OFF</option><option value="ALLONES">ALLONES</option><option value="ALLZEROS">ALLZEROS</option></select></div><div class="dropdown-cause-literal-type" style="margin-left:-10px">Data Type:<select id="literalTypeCause" style="margin-left:3px"><option value="-1">Select One</option><option value="literalCause">Literal</option><option value="regCause">Reg</option></select></div><div class="dropdown-cause-bit-type" style="margin-left:-11px">BITS:<select id="noOfBitsCause" style="margin-left:4px"><option value="-1">Select One</option><option value="32">32</option><option value="64">64</option></select></div><label style="margin-left:3px" class="bitNumCause">BIT Number</label><input type = "text" class ="bitNumber" style="margin-left:4px;width:60px" onkeypress="return isNumber(event)"/><label style="margin-left:4px" class="box1Cause">Data</label><input type = "text" class ="box1" style="margin-left:4px;width:90px"/><label style="margin-left:3px" class="box2Cause">Mask</label><input type = "text" class ="box2" style="margin-left:3px;width:90px"/><input type="button" onclick="addCause(this)" value="Add" style="margin-left:4px"/><input type="button" onclick="removeCause(this)" value="Remove" style="margin-left:4px"/>`, {
				'class': 'dropdown-parent-cause',
				'data-attr': 'attr',
				'data-count': lastCount+1,
				'id':'causeDiv'+(lastCount+1)
			});
			var divid='causeDiv'+(lastCount+1);
			$("#"+divid+" .bitNumber").hide();
			$("#"+divid+" .bitNumCause").hide();
			$("#"+divid+" .box1").hide();
			$("#"+divid+" .box1Cause").hide();
			$("#"+divid+" .box2").hide();
			$("#"+divid+" .box2Cause").hide();
			$("#"+divid+" .dropdown-cause-literal-type").hide();
			$("#"+divid+" .dropdown-cause-bit-type").hide();

			causeCount=lastCount+1;
		}
		function addEffect(that) {
			var lastCount = $(that).parent().parent().find('.dropdown-parent-effect').last().data().count;
			addDiv('effectDiv', `<div class="dropdown-effect-data-type" style="margin-left:-14px">Address type:<select id="dataTypeEffect" style="margin-left:4px"><option value="-1">Select One</option><option value="regEffect">Reg</option><option value="logicEffect">Logic</option></select></div><label style="margin-left:4px">Target Address</label><input type = "text" class ="targetEffectAddr" style="margin-left:5px;width:90px" onblur="isValidhexTargetAddressEffect(this)"/><div class="dropdown-effect-operation" style="margin-left:3px">Operation: <select id="operationEffect" onchange="showProperTextBoxEffect(this)"><option value="-1">Select One</option><option value="AND">AND</option><option value="OR">OR</option><option value="EQUALTO">EQUALTO</option><option value="BIT_ON">BIT_ON</option><option value="BIT_OFF">BIT_OFF</option><option value="ALLONES">ALLONES</option><option value="ALLZEROS">ALLZEROS</option></select></div><div class="dropdown-effect-literal-type" style="margin-left:-10px">Data Type:<select id="literalTypeEffect" style="margin-left:3px"><option value="-1">Select One</option><option value="literalEffect">Literal</option><option value="regEffect">Reg</option></select></div><div class="dropdown-effect-bit-type" style="margin-left:-11px">BITS:<select id="noOfBitsEffect" style="margin-left:4px"><option value="-1">Select One</option><option value="32">32</option><option value="64">64</option></select></div><label style="margin-left:3px" class="bitNumEffect">BIT Number</label><input type = "text" class ="bitNumberEffect" style="margin-left:4px;width:60px" onkeypress="return isNumber(event)"/><label style="margin-left:4px" class="box1Eff">Data</label><input type = "text" class ="box1effect" style="margin-left:4px;width:90px"/><label style="margin-left:3px" class="box2Eff">Mask</label><input type = "text" class ="box2effect" style="margin-left:3px;width:90px"/><input type="button" onclick="addEffect(this)" value="Add" style="margin-left:4px"/><input type="button" onclick="removeEffect(this)" value="Remove" style="margin-left:4px"/>`, {
				'class': 'dropdown-parent-effect',
				'data-attr': 'attr',
				'data-count': lastCount+1,
				'id':'effectDiv'+(lastCount+1)
			});
			var divid='effectDiv'+(lastCount+1);
			$("#"+divid+" .bitNumEffect").hide();
			$("#"+divid+" .bitNumberEffect").hide();
			$("#"+divid+" .box1Eff").hide();
			$("#"+divid+" .box1effect").hide();
			$("#"+divid+" .box2Eff").hide();
			$("#"+divid+" .box2effect").hide();
			$("#"+divid+" .dropdown-effect-literal-type").hide();
			$("#"+divid+" .dropdown-effect-bit-type").hide();

			effectCount=lastCount+1;
		}
		function removeCause(that) {
			var r = confirm("Do you want to delete the cause?");
			if (r == true) {
				var cause = document.getElementById("cause").value;
				var rowCountCause = $(that).parent().parent().find('.dropdown-parent-cause').last().data().count;
				if(rowCountCause=='1' && cause=='yes'){
					alert("Please select No in causes");
					return false;
				}
				$(that).closest('.dropdown-parent-cause').remove();
			}
		}
		function removeEffect(that) {
			var r = confirm("Do you want to delete the effect?");
			if (r == true) {
				var rowCountEffect = $(that).parent().parent().find('.dropdown-parent-effect').last().data().count;
				if(rowCountEffect=='1'){
					alert("Please have at least one row for Preview");
					return false;
				}
				$(that).closest('.dropdown-parent-effect').remove();
			}
		}
		function addDiv(parent_div, content, attrs) {
			var div = document.createElement('div');
			var parent = document.getElementById(parent_div);

			for (var key in attrs) {
				if (attrs.hasOwnProperty(key)) {
					div.setAttribute(key, attrs[key]);
				}
			}
			div.innerHTML = content;
			if (parent) {
				parent.appendChild(div);
			}
		}

		function showProperTextBox(that){
			var divid=$(that).parents(':eq(1)').attr("id");
			var dd_val=$(that).val();
			if(dd_val=='BIT_ON' || dd_val=='BIT_OFF'){
				$("#"+divid+" .bitNumber").show();
				$("#"+divid+" .bitNumCause").show();
				$("#"+divid+" .box1").hide();
				$("#"+divid+" .box1Cause").hide();
				$("#"+divid+" .box2").hide();
				$("#"+divid+" .box2Cause").hide();
				$("#"+divid+" .dropdown-cause-bit-type").hide();
				$("#"+divid+" .dropdown-cause-literal-type").hide();
			}else if(dd_val=='AND' || dd_val=='OR' || dd_val=='EQUALTO'){
				$("#"+divid+" .bitNumber").hide();
				$("#"+divid+" .bitNumCause").hide();
				$("#"+divid+" .box1").show();
				$("#"+divid+" .box1Cause").show();
				$("#"+divid+" .box2").show();
				$("#"+divid+" .box2Cause").show();
				$("#"+divid+" .dropdown-cause-bit-type").show();
				$("#"+divid+" .dropdown-cause-literal-type").show();
			}else{
				$("#"+divid+" .bitNumber").hide();
				$("#"+divid+" .bitNumCause").hide();
				$("#"+divid+" .box1").hide();
				$("#"+divid+" .box1Cause").hide();
				$("#"+divid+" .box2").hide();
				$("#"+divid+" .box2Cause").hide();
				$("#"+divid+" .dropdown-cause-bit-type").hide();
				$("#"+divid+" .dropdown-cause-literal-type").hide();
			}
		}
		function showProperTextBoxEffect(that){
			var divid=$(that).parents(':eq(1)').attr("id");
			var dd_val=$(that).val();
			if(dd_val=='BIT_ON' || dd_val=='BIT_OFF'){
				$("#"+divid+" .bitNumEffect").show();
				$("#"+divid+" .bitNumberEffect").show();
				$("#"+divid+" .box1Eff").hide();
				$("#"+divid+" .box1effect").hide();
				$("#"+divid+" .box2Eff").hide();
				$("#"+divid+" .box2effect").hide();				
				$("#"+divid+" .dropdown-effect-bit-type").hide();
				$("#"+divid+" .dropdown-effect-literal-type").hide();
			}else if(dd_val=='AND' || dd_val=='OR' || dd_val=='EQUALTO'){
				$("#"+divid+" .bitNumEffect").hide();
				$("#"+divid+" .bitNumberEffect").hide();
				$("#"+divid+" .box1Eff").show();
				$("#"+divid+" .box1effect").show();
				$("#"+divid+" .box2Eff").show();
				$("#"+divid+" .box2effect").show();
				$("#"+divid+" .dropdown-effect-bit-type").show();
				$("#"+divid+" .dropdown-effect-literal-type").show();
			}else{
				$("#"+divid+" .bitNumEffect").hide();
				$("#"+divid+" .bitNumberEffect").hide();
				$("#"+divid+" .box1Eff").hide();
				$("#"+divid+" .box1effect").hide();
				$("#"+divid+" .box2Eff").hide();
				$("#"+divid+" .box2effect").hide();
				$("#"+divid+" .dropdown-effect-bit-type").hide();
				$("#"+divid+" .dropdown-effect-literal-type").hide();
			}
		}
		//To test Hex Values in Watch Reg
		function isValidhex(ele)
		{
			var value=ele.value;
			var regExp = new RegExp(/^0x[0-9A-F]{1,16}$/i);
			if(value.length!=10 && value.length!=18 ){
				alert("Please enter valid value in Watch Reg");
				return false;
			}
			else if (!regExp.test(ele.value)){
				alert("Please enter valid value in Watch Reg");
				return false;
			}
		}
		// TO check hex values for watch reg while preview action
		function isValidhexValueWatchReg(value)
		{
			var regExp = new RegExp(/^0x[0-9A-F]{1,16}$/i);
			if(value.length!=10 && value.length!=18 ){
				return false;
			}
			else if (!regExp.test(value)){
				return false;
			}else{
				return true;
			}
		}
		// TO check hex values for Target Address in Cause reg while preview action
				function isValidhexValueTargetCause(value)
		{
			var regExp = new RegExp(/^0x[0-9A-F]{1,16}$/i);
			if(value.length!=10 && value.length!=18 ){
				return false;
			}
			else if (!regExp.test(value)){
				return false;
			}else{
				return true;
			}
		}
		// TO check hex values for Target Address in Effect while preview action
				function isValidhexValueTargetEffect(value)
		{
			var regExp = new RegExp(/^0x[0-9A-F]{1,16}$/i);
			if(value.length!=10 && value.length!=18 ){
				return false;
			}
			else if (!regExp.test(value)){
				return false;
			}else{
				return true;
			}
		}
		//To test Hex Values in Target Address in Cause
		function isValidhexTargetAddressCause(ele)
		{
			var value=ele.value;
			var regExp = new RegExp(/^0x[0-9A-F]{1,16}$/i);
			if(value.length!=10 && value.length!=18 ){
				alert("Please enter valid value in Target Address in Cause");
			}
			else if (!regExp.test(ele.value)){
				alert("Please enter valid value in Target Address in Cause");
			}
		}
		//To test Hex Values in Target Address in Effect
		function isValidhexTargetAddressEffect(ele)
		{
			var value=ele.value;
			var regExp = new RegExp(/^0x[0-9A-F]{1,16}$/i);
			if(value.length!=10 && value.length!=18 ){
				alert("Please enter valid value in Target Address in Effect");
			}
			else if (!regExp.test(ele.value)){
				alert("Please enter valid value in Target Address in Effect");
			}
		}

		function isValidhex_32(value)
		{
			var value_length=value.length;
			var regExp = new RegExp(/^0x[0-9A-F]{1,8}$/i);
			if(value_length!=10){
				return false;
			}
			else if (!regExp.test(value)){
				return false;
			}else{
				return true;
			}
		}
		function isValidhex_64(value)
		{
			var value_length=value.length;
			var regExp = new RegExp(/^0x[0-9A-F]{1,16}$/i);
			if(value_length!=18){
				return false;
			}
			else if (!regExp.test(value)){
				return false;
			}else{
				return true;
			}
		}

		function isValidBinaryNumberCause(ele)
		{
			var regExp = new RegExp('^[0-9]{1,10}$');
			if (!regExp.test(ele.value)){
				alert("Please enter valid BIT Number in Cause");
			}
		}
		function isValidBinaryNumberEffect(ele)
		{
			var regExp = new RegExp('^[0-9]{1,10}$');
			if (!regExp.test(ele.value)){
				alert("Please enter valid BIT Number in Effect");
			}
		}
		function isNumber(evt) {
			evt = (evt) ? evt : window.event;
			var charCode = (evt.which) ? evt.which : evt.keyCode;
			if (charCode > 31 && (charCode < 48 || charCode > 57)) {
				return false;
			}
			return true;
		}
		function showcheckboxes(){
			var chiplet=$("#chiplet").val();
			if(chiplet=='yes'){
				$(".dropdown-parent-chiplet").show();
			}
			else{
				$(".dropdown-parent-chiplet").hide();
			}
		}

	</script>

	<div id="navigation" style="width: 1312px;">
		<center>
			<h1>Dynamic Code Generator</h1>
		</center>
		<div class="dropdown" style="margin-left:-15px">
			Do you want to select the Chiplets:
			<select id="chiplet" onchange="showcheckboxes()">
				<option value="-1">Select One</option>
				<option value="yes">Yes</option>
				<option value="no">No</option>
			</select>

			<div class="dropdown-parent-chiplet">
				<label><input id="checkbox1" type="checkbox" name="selector[]" value="xbus">xbus</label>
				<label><input id="checkbox2" type="checkbox" name="selector[]" value="cache">cache</label>
				<label><input id="checkbox3" type="checkbox" name="selector[]" value="ec">ec</label>
				<label><input id="checkbox4" type="checkbox" name="selector[]" value="obus">obus</label>
				<label><input id="checkbox5" type="checkbox" name="selector[]" value="tp">tp</label>
				<label><input id="checkbox6" type="checkbox" name="selector[]" value="nest">nest</label>
				<label><input id="checkbox7" type="checkbox" name="selector[]" value="pcie">pcie</label>			
			</div>
		</div>

		<div class="dropdown-parent">
			<label style="margin-left:1px">Label</label>
			<input type="text" id="label" />
		</div>
		<div class="dropdown-parent">
			<div class="dropdown" style="margin-left:-15px">
				How you want your address to be:
				<select id="addrChoice">
					<option value="-1">Select One</option>
					<option value="reg">Reg</option>
					<option value="logic">Logic</option>
				</select>
			</div>			
			<label>Watch Reg</label>
			<input type="text" id="watchReg" onblur="isValidhex(this)"/>
		</div>
	<div class="dropdown" style="margin-left:-15px">
		Do you want to select the Causes:
		<select id="cause" onchange="showCauseDiv()">
			<option value="-1">Select One</option>
			<option value="yes">Yes</option>
			<option value="no">No</option>
		</select>
	</div>
	<div id="causeDiv">
		<div class="dropdown-parent-cause" data-count=1 id="causeDiv1">
			<div class="dropdown-cause-data-type" style="margin-left:-16px">
						Address type:
						<select id="dataTypeCause">
							<option value="-1">Select One</option>
							<option value="regCause">Reg</option>
							<option value="logicCause">Logic</option>
						</select>
			</div>
			<label>Target Address</label>
			<input type="text" class="targetAddr" style="width: 90px;" onblur="isValidhexTargetAddressCause(this)"/>
			<div class="dropdown-cause-operation">
				Operation:
				<select id="operation" onchange="showProperTextBox(this)">
					<option value="-1">Select One</option>
					<option value="AND">AND</option>
					<option value="OR">OR</option>
					<option value="EQUALTO">EQUALTO</option>
					<option value="BIT_ON">BIT_ON</option>
					<option value="BIT_OFF">BIT_OFF</option>
					<option value="ALLONES">ALLONES</option>
					<option value="ALLZEROS">ALLZEROS</option>
				</select>
			</div>
			<div class="dropdown-cause-literal-type" style="margin-left:-15px">
					Data Type:
					<select id="literalTypeCause">
						<option value="-1">Select One</option>
						<option value="literalCause">Literal</option>
						<option value="regCause">Reg</option>
					</select>
			</div>
			<div class="dropdown-cause-bit-type" style="margin-left:-15px">
					BITS:
					<select id="noOfBitsCause">
						<option value="-1">Select One</option>
						<option value="32">32</option>
						<option value="64">64</option>
				</select>
			</div>

			<label class="bitNumCause">BIT Number</label>
			<input type="text" class="bitNumber" style="width: 60px;" onkeypress="return isNumber(event)"/>

			<label class="box1Cause">Data</label>
			<input type="text" style="width: 90px;" class="box1" />

			<label class="box2Cause" style="margin-left: 1px;">Mask</label>
			<input type="text"  style="width: 90px;" class="box2" />

			<input data-count="1" type="button" onclick="addCause(this)" value="Add" />
			<input data-count="1" type="button" onclick="removeCause(this)" value="Remove"/>
		</div>
	</div>
		</br></br>
		<div style="margin-left:1px">
			Please add the Effects:
		</div>
		<div id="effectDiv">
			<div class="dropdown-parent-effect" data-count=1 id="effectDiv1">
				<div class="dropdown-effect-data-type" style="margin-left:-16px">
							Address type:
							<select id="dataTypeEffect">
								<option value="-1">Select One</option>
								<option value="regEffect">Reg</option>
								<option value="logicEffect">Logic</option>
					</select>
				</div>
				<label>Target Address</label>
				<input type="text" class="targetEffectAddr" style="width: 90px;" onblur="isValidhexTargetAddressEffect(this)"/>
				<div class="dropdown-effect-operation">
					Operation:
					<select id="operationEffect" onchange="showProperTextBoxEffect(this)">
						<option value="-1">Select One</option>
						<option value="AND">AND</option>
						<option value="OR">OR</option>
						<option value="EQUALTO">EQUALTO</option>
						<option value="BIT_ON">BIT_ON</option>
						<option value="BIT_OFF">BIT_OFF</option>
						<option value="ALLONES">ALLONES</option>
						<option value="ALLZEROS">ALLZEROS</option>
					</select>
				</div>
				<div class="dropdown-effect-literal-type" style="margin-left:-15px">
						Data Type:
						<select id="literalTypeEffect">
							<option value="-1">Select One</option>
							<option value="literalEffect">Literal</option>
							<option value="regEffect">Reg</option>
						</select>
				</div>
				<div class="dropdown-effect-bit-type" style="margin-left:-15px">
						BITS:
						<select id="noOfBitsEffect">
							<option value="-1">Select One</option>
							<option value="32">32</option>
							<option value="64">64</option>
					</select>
				</div>
				<label class="bitNumEffect">BIT Number</label>
				<input type="text" class="bitNumberEffect" style="width: 60px;" onkeypress="return isNumber(event)"/>
				
				<label class="box1Eff">Data</label>
				<input type="text" style="width: 90px;" class="box1effect"/>

				<label class="box2Eff" style="margin-left: 1px;">Mask</label>
				<input type="text" style="width: 90px;" class="box2effect" />

				<input type="button" onclick="addEffect(this)" value="Add" />
				<input data-count="1" type="button" onclick="removeEffect(this)" value="Remove"/>
			</div>
		</div>
	
		<div id="previewAction">
			<textarea id="prevAction" rows="25" cols="100" readonly style="margin: 29px 0px 0px 2px;width: 1093px;height: 370px;"></textarea>
		</div>
		<br>
		<br>
		<div>
			<tr class="dropdown-parent">
				<td>
					<button onclick="previewAct()" style="margin-left:390px">Preview Action</button>
				</td>
				<td>
					<button onclick="hidePreviewAct()">Hide Preview</button>
				</td>
			</tr>
			<br>
			<br>
		</div>
		<div style="margin-left:262px">
			<tr>
				<td>Filename to Save As:</td>
				<td>
					<input id="inputFileNameToSaveAs"></input>
				</td>
				<td>
					<button onclick="saveTextAsFile()">Generate Action File</button>
				</td>
			</tr>
		</div>
		<div style="margin-left:-89px">
			<br>
			<br>
			<button onclick="resetAllFields()" style="margin-left:534px">Reset</button>
		</div>
	</div>
</body>

</html>